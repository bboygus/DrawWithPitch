(()=>{"use strict";var e={723:(e,t)=>{function o(e){e.classList.toggle("is-active")}Object.defineProperty(t,"__esModule",{value:!0}),t.default={setupModals:function(){document.querySelectorAll("[data-bulma-target='modal']").forEach((e=>{const t=e.dataset.bulmaTargetId;if(!t)return;const n=document.getElementById(t);if(!n)return void console.error("There is no HTMLElement with id "+t);const r=e.dataset.bulmaTrigger??"click",a=()=>o(n);e.removeEventListener(r,a),e.addEventListener(r,a)})),document.querySelectorAll(".modal").forEach((e=>{e.querySelectorAll("[data-bulma-modal='close'], .modal-background").forEach((t=>{const n=()=>o(e);t.removeEventListener("click",n),t.addEventListener("click",n)}))}))}}},224:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NOTE=t.model_url=t.background_color=void 0,t.background_color="#363636",t.model_url="https://cdn.jsdelivr.net/gh/ml5js/ml5-data-and-models/models/pitch-detection/crepe/",t.NOTE=Object.freeze([{move:[0,-1],name:"A"},{move:[1,-1],name:"AB"},{move:[1,0],name:"B"},{move:[1,1],name:"C"},{move:[0,1],name:"CD"},{move:[-1,1],name:"D"},{move:[-1,0],name:"DE"},{move:[-1,-1],name:"E"},{move:[0,0],name:"F"},{move:[0,0],name:"FG"},{move:[0,0],name:"G"},{move:[0,0],name:"GA"}])},972:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(723)),a=o(224),c=document.getElementById("canvas-container"),i=document.getElementById("start");window.addEventListener("load",(async function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/DrawWithPitch/service-worker.bundle.min.js"),r.default.setupModals(),new p5((e=>{const t=document.querySelector("direction-indicator");let o,n,r,l=null,d=[0,0];async function u(){n=ml5.pitchDetection(a.model_url,e.getAudioContext(),r.stream,s)}async function s(){n.getPitch((function(e,t){l=t,s()}))}e.setup=function(){const t=+window.getComputedStyle(c).getPropertyValue("width").replace("px","");e.createCanvas(t,t),o=e.createGraphics(t,t),o.clear(),e.background(a.background_color),d=[e.width/2,e.height/2],new ResizeObserver((()=>{const t=+window.getComputedStyle(c).getPropertyValue("width").replace("px","");e.resizeCanvas(t,t),e.background(a.background_color)})).observe(c),r=new p5.AudioIn,i.onclick=()=>{e.getAudioContext().resume(),r.start(u),i.parentElement.removeChild(i)},document.getElementById("clear-canvas").onclick=()=>{e.getAudioContext().resume(),e.background(a.background_color),o.clear(),d=[e.width/2,e.height/2]}},e.draw=function(){if(!l)return void t.removeAttribute("direction");const n=(r=12*Math.log(l/440)/Math.log(2),a.NOTE[+Math.abs(r).toFixed()%12]);var r;const c=function(t){function o(e,t,o=0){return Math.min(Math.max(e,o),t)}return[o(d[0]+2*t.move[0],e.width),o(d[1]+2*t.move[1],e.height)]}(n);t.setAttribute("direction",n.name),d[0]==c[0]&&d[1]==c[1]||(o.strokeWeight(1),o.stroke(255),o.line(...d,...c),d=c,e.background(a.background_color),e.image(o,0,0,e.width,e.height),e.fill(255,0,0),e.ellipse(...c,4,4))}}),c)}))}},t={};!function o(n){if(t[n])return t[n].exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}(972)})();