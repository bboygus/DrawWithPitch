(()=>{"use strict";var e={969:(e,t)=>{function o(e){e.classList.toggle("is-active")}Object.defineProperty(t,"__esModule",{value:!0}),t.default={setupModals:function(){document.querySelectorAll("[data-bulma-target='modal']").forEach((e=>{const t=e.dataset.bulmaTargetId;if(!t)return;const n=document.getElementById(t);if(!n)return void console.error("There is no HTMLElement with id "+t);const r=e.dataset.bulmaTrigger??"click",a=()=>o(n);e.removeEventListener(r,a),e.addEventListener(r,a)})),document.querySelectorAll(".modal").forEach((e=>{e.querySelectorAll("[data-bulma-modal='close'], .modal-background").forEach((t=>{const n=()=>o(e);t.removeEventListener("click",n),t.addEventListener("click",n)}))}))}}},733:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NOTE=t.model_url=t.background_color=void 0,t.background_color="#363636",t.model_url="https://cdn.jsdelivr.net/gh/ml5js/ml5-data-and-models/models/pitch-detection/crepe/",t.NOTE=Object.freeze([{move:[0,-1],name:"A"},{move:[1,-1],name:"AB"},{move:[1,0],name:"B"},{move:[1,1],name:"C"},{move:[0,1],name:"CD"},{move:[-1,1],name:"D"},{move:[-1,0],name:"DE"},{move:[-1,-1],name:"E"},{move:[0,0],name:"F"},{move:[0,0],name:"FG"},{move:[0,0],name:"G"},{move:[0,0],name:"GA"}])},939:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(o(969)),a=o(733),c=document.getElementById("canvas-container"),i=document.getElementById("start");window.addEventListener("load",(async function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/public/service-worker.bundle.min.js"),r.default.setupModals(),new p5((e=>{const t=document.querySelector("direction-indicator");let o,n,r=null,d=[0,0];async function l(){o=ml5.pitchDetection(a.model_url,e.getAudioContext(),n.stream,u)}async function u(){o.getPitch((function(e,t){u(),t&&(r=t)}))}e.setup=function(){const t=+window.getComputedStyle(c).getPropertyValue("width").replace("px","");e.createCanvas(t,t),e.background(a.background_color),d=[e.width/2,e.height/2],new ResizeObserver((()=>{const t=+window.getComputedStyle(c).getPropertyValue("width").replace("px","");e.resizeCanvas(t,t),e.background(a.background_color)})).observe(c),n=new p5.AudioIn,i.onclick=()=>{e.getAudioContext().resume(),n.start(l),i.parentElement.removeChild(i)},document.getElementById("clear-canvas").onclick=()=>{e.getAudioContext().resume(),e.background(a.background_color),d=[e.width/2,e.height/2]}},e.draw=function(){if(!r)return void t.removeAttribute("direction");const o=(n=12*Math.log(r/440)/Math.log(2),a.NOTE[+Math.abs(n).toFixed()%12]);var n;const c=function(t){function o(e,t,o=0){return Math.min(Math.max(e,o),t)}return[o(d[0]+2*t.move[0],e.width),o(d[1]+2*t.move[1],e.height)]}(o);t.setAttribute("direction",o.name),console.log(d,c),d[0]==c[0]&&d[1]==c[1]||(e.strokeWeight(1),e.stroke(255),e.line(...d,c[0],c[1]),d=c)}}),c)}))}},t={};!function o(n){if(t[n])return t[n].exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}(939)})();