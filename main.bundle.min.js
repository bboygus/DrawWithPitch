(()=>{"use strict";var e={347:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(o(30)),r=n(o(723));t.default={NavBar:a.default,Modal:r.default}},723:(e,t)=>{function o(e){e.classList.toggle("is-active")}Object.defineProperty(t,"__esModule",{value:!0}),t.default={setupModals:function(){document.querySelectorAll("[data-bulma-target='modal']").forEach((e=>{const t=e.dataset.bulmaTargetId;if(!t)return;const n=document.getElementById(t);if(!n)return void console.error("There is no HTMLElement with id "+t);const a=e.dataset.bulmaTrigger??"click",r=()=>o(n);e.removeEventListener(a,r),e.addEventListener(a,r)})),document.querySelectorAll(".modal").forEach((e=>{e.querySelectorAll("[data-bulma-modal='close'], .modal-background").forEach((t=>{const n=()=>o(e);t.removeEventListener("click",n),t.addEventListener("click",n)}))}))}}},30:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default={setupNavbar:function(){const e=document.querySelectorAll(".navbar-burger");e.length&&e.forEach((e=>{e.addEventListener("click",(()=>{const t=e.dataset.target?document.getElementById(e.dataset.target):void 0;e.classList.toggle("is-active"),t?.classList.toggle("is-active")}))}))}}},224:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NOTE=t.model_url=t.background_color=void 0,t.background_color="#363636",t.model_url="https://cdn.jsdelivr.net/gh/ml5js/ml5-data-and-models/models/pitch-detection/crepe/",t.NOTE=Object.freeze([{move:[0,-1],name:"A"},{move:[1,-1],name:"AB"},{move:[1,0],name:"B"},{move:[1,1],name:"C"},{move:[0,1],name:"CD"},{move:[-1,1],name:"D"},{move:[-1,0],name:"DE"},{move:[-1,-1],name:"E"},{move:[0,0],name:"F"},{move:[0,0],name:"FG"},{move:[0,0],name:"G"},{move:[0,0],name:"GA"}])},972:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=n(o(347)),r=o(224),c=document.getElementById("canvas-container"),i=document.getElementById("start");window.addEventListener("DOMContentLoaded",a.default.NavBar.setupNavbar),window.addEventListener("load",(async function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/DrawWithPitch/service-worker.bundle.min.js"),a.default.Modal.setupModals(),new p5((e=>{const t=document.querySelector("direction-indicator");let o,n,a,d=null,l=[0,0];async function s(){n=ml5.pitchDetection(r.model_url,e.getAudioContext(),a.stream,u)}async function u(){n.getPitch((function(e,t){d=t,u()}))}e.setup=function(){const t=+window.getComputedStyle(c).getPropertyValue("width").replace("px","");e.createCanvas(t,t),e.background(r.background_color),o=e.createGraphics(t,t),o.clear(),l=[e.width/2,e.height/2],new ResizeObserver((()=>{const t=+window.getComputedStyle(c).getPropertyValue("width").replace("px","");e.resizeCanvas(t,t),o.resizeCanvas(t,t)})).observe(c),a=new p5.AudioIn,i.onclick=()=>{e.getAudioContext().resume(),a.start(s),i.parentElement.removeChild(i)},document.getElementById("clear-canvas").onclick=()=>{e.getAudioContext().resume(),e.background(r.background_color),o.clear(),l=[e.width/2,e.height/2]},document.getElementById("save-canvas").onclick=()=>{e.saveCanvas(o,"DrawWithPitch","jpg")}},e.draw=function(){if(!d)return void t.removeAttribute("direction");const n=(a=12*Math.log(d/440)/Math.log(2),r.NOTE[+Math.abs(a).toFixed()%12]);var a;const c=function(t){function o(e,t,o=0){return Math.min(Math.max(e,o),t)}return[o(l[0]+2*t.move[0],e.width),o(l[1]+2*t.move[1],e.height)]}(n);t.setAttribute("direction",n.name),l[0]==c[0]&&l[1]==c[1]||(o.strokeWeight(1),o.stroke(255),o.line(...l,...c),l=c,e.background(r.background_color),e.image(o,0,0,e.width,e.height),e.fill(255,0,0),e.ellipse(...c,4,4))}}),c)}))}},t={};!function o(n){if(t[n])return t[n].exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}(972)})();